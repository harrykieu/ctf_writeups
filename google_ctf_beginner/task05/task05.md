## Tools need to use  
- Python
- [randcrack](https://github.com/tna0y/Python-random-module-cracker)
## Solution
Download and extract the zip file in "WHAT YOU'LL NEED" part, we have 3 files: `robo_numbers_list.txt`, `RoboCaller1337.py` and `secret.enc`.  
Reading the code in RoboCaller1337.py, I found the function for encoding the secret:
              
```
def encodeSecret(s):
    key = [random.getrandbits(8) for i in range(len(s))]
    return bytes([a^b for a,b in zip(key,list(s.encode()))])
```

Basically, this function has the following attributes:  
- The `key` list is made by using the `random.getrandbits` function: For each letter in the secret string, add an 8-bit number.
- `s.encode()` encode the secret string by default method - UTF-8. `list(s.encode())` return UTF-8 code of the string.
- `zip` method return a `zip` object - a tuple in which each elements of `key` and `s.encode()` are combined into a tuple inside the main tuple.
- `a^b` is a XOR b (first I thought `a^b` is a exp b LOL), which basically is converting `a` and `b` into binary and comparing each respectively bit of each number, and return `1` if 1 of 2 bits is 1 and the other is 0; else returns `0`. Ex: `2 -> 10, 4 -> 100, 2^4 -> 110 -> 6`
- Make a list by using list comprehension: `[a^b for a,b in zip(key,list(s.encode()))]`
- Convert the list to byte objects.  
              
Now, we need to break the `random.getrandbits()` function to find the key.   
              
The `getrandbits` method uses the Mersenne Twister matrix, which would be cracked if you have the first 624 32-bit numbers from the generator. Luckily, the program has those methods to generate exactly those numbers under the type of phone number. Those number was obtained in the `robo_numbers_list.txt` file.  
              
```
# Gots to get that formatting right when send it to our call center
def formatNumber(n):
    n = str(n)
    return f'{n[:3]}-{n[3:6]}-{n[6:]}'

# This generates random phone numbers because it's easy to find a lot of people!
# Our number generator is not great so we had to hack it a bit to make sure we can
# reach folks in Philly (area code 215)
def generateRandomNumbers():
    arr = []
    for i in range(624):
        arr.append(formatNumber(random.getrandbits(32) + (1<<31)))
    return arr   
```
The method `generateRandomNumbers` generated 624 32-bit number, then add `1<<31` (1 left shift by 31 = `2147483648` for unsigned number). After that, those numbers are formatted by `formatNumber` function to the form `XXX-XXX-XXXX`.  
              
So, to crack the `getrandbits` method, we use [randcrack](https://github.com/tna0y/Python-random-module-cracker). To predict the new number, this tool needs to feed exactly 624 pre-generated number by the method, which is the number on `robo_numbers_list.txt` file (I removed the dash and saved them in `number.txt` file)
minus 1<<31.  
                                                          
The file `secret.enc` has a size of 31 bytes, so we need a key - 31 numbers generated by `encodeSecret` function to decode this file.  

The reverse function of XOR is XOR itself, and when we know 2 of 3 elements in XOR function, we can find the remaining element: `a^b = c -> b = c^a` => Using the key generated by `randcrack` and the byte read on `secret.enc`, we can find the flag. I made a decode function in `decodefunction.py` file and using this, we can find the flag: `CTF{n3v3r_3ver_ev3r_use_r4nd0m}`
